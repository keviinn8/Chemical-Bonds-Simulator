<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>Ionic3DController.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">ChemistryProj</a> &gt; <a href="index.source.html" class="el_package">com.example.chemistryprojControllers</a> &gt; <span class="el_source">Ionic3DController.java</span></div><h1>Ionic3DController.java</h1><pre class="source lang-java linenums">package com.example.chemistryprojControllers;

import com.example.chemistryproj.Electron;
import com.example.chemistryproj.HelloApplication;
import com.example.chemistryproj.Ion;
import com.example.chemistryprojControllers.IonicController;
import javafx.animation.Animation;
import javafx.animation.AnimationTimer;
import javafx.animation.TranslateTransition;
import javafx.beans.property.DoubleProperty;
import javafx.beans.property.SimpleDoubleProperty;
import javafx.event.ActionEvent;
import javafx.fxml.FXML;
import javafx.fxml.FXMLLoader;
import javafx.fxml.Initializable;
import javafx.scene.*;
import javafx.scene.control.Button;
import javafx.scene.input.ScrollEvent;
import javafx.scene.layout.HBox;
import javafx.scene.layout.Pane;
import javafx.scene.paint.Color;
import javafx.scene.paint.PhongMaterial;
import javafx.scene.shape.Sphere;
import javafx.scene.transform.Rotate;
import javafx.scene.transform.Transform;
import javafx.scene.transform.Translate;
import javafx.stage.Stage;
import javafx.util.Duration;

import java.io.IOException;
import java.net.URL;
import java.util.ArrayList;
import java.util.Random;
import java.util.ResourceBundle;

<span class="nc" id="L36">public class Ionic3DController implements Initializable {</span>
    @FXML
    private Button BackButton;
    @FXML
    private HBox hBox;
    @FXML
    private Pane pane;
    @FXML
    private Button switchButton;

    private ArrayList&lt;Ion&gt; arrayIons;
    private double anchorX, anchorY;
<span class="nc" id="L48">    private double anchorAngleX = 0;</span>
<span class="nc" id="L49">    private double anchorAngleY = 0;</span>
<span class="nc" id="L50">    private final DoubleProperty angleX = new SimpleDoubleProperty(0);</span>
<span class="nc" id="L51">    private final DoubleProperty angleY = new SimpleDoubleProperty(0);</span>
    private Stage stage;
    SubScene scene;
    private ArrayList&lt;Ion&gt; arrayOf2Ions;

<span class="nc" id="L56">    private ArrayList&lt;Ion&gt; metalIons = new ArrayList&lt;&gt;();</span>
<span class="nc" id="L57">    private ArrayList&lt;Ion&gt; nonMetalIons = new ArrayList&lt;&gt;();</span>

<span class="nc" id="L59">    private int counter = 1;</span>


    @Override
    public void initialize(URL url, ResourceBundle resourceBundle) {
<span class="nc" id="L64">        arrayIons = IonicController.getArrIons();</span>
<span class="nc bnc" id="L65" title="All 2 branches missed.">        for (Ion ion : arrayIons) {</span>
<span class="nc bnc" id="L66" title="All 2 branches missed.">            if (ion.isMetal) {</span>
<span class="nc" id="L67">                metalIons.add(ion);</span>
            } else {
<span class="nc" id="L69">                nonMetalIons.add(ion);</span>
            }
<span class="nc" id="L71">        }</span>
<span class="nc bnc" id="L72" title="All 2 branches missed.">        for (int i = 0; i &lt; nonMetalIons.size(); i++) {</span>
<span class="nc" id="L73">            Ion ion = nonMetalIons.get(i);</span>
<span class="nc" id="L74">            Button b = new Button(nonMetalIons.get(i).toString());</span>
<span class="nc" id="L75">            b.setMinSize(70, 50);</span>
<span class="nc" id="L76">            hBox.getChildren().add(b);</span>
<span class="nc" id="L77">            b.setOnAction(e -&gt; {</span>
<span class="nc" id="L78">                pane.getChildren().remove(scene);</span>
<span class="nc" id="L79">                createSphereAndPutItInScene(ion);</span>
<span class="nc" id="L80">            });</span>
        }
<span class="nc" id="L82">        arrayOf2Ions = IonicController.getArrayOfIonsCreated();</span>

<span class="nc" id="L84">    }</span>

    private Group createNucleus(Ion ion, Color c) {
<span class="nc" id="L87">        double radius = 6;</span>
<span class="nc" id="L88">        Group g = new Group();</span>
<span class="nc" id="L89">        Random r = new Random();</span>
<span class="nc bnc" id="L90" title="All 2 branches missed.">        for (int i = 0; i &lt; ion.protons; i++) {</span>
<span class="nc" id="L91">            Sphere s = new Sphere(3);</span>
<span class="nc" id="L92">            double d = r.nextDouble(0, 2 * Math.PI);</span>
<span class="nc" id="L93">            double dx = r.nextDouble(-radius, radius + 1);</span>
<span class="nc" id="L94">            double dy = r.nextDouble(-radius, radius + 1);</span>
<span class="nc" id="L95">            double dz = r.nextDouble(-radius, radius + 1);</span>

<span class="nc" id="L97">            s.setTranslateX(dx * Math.cos(d));</span>
<span class="nc" id="L98">            s.setTranslateY(dy * Math.sin(d));</span>
<span class="nc" id="L99">            s.setTranslateZ(dz);</span>

<span class="nc" id="L101">            PhongMaterial material = new PhongMaterial();</span>
<span class="nc" id="L102">            material.setDiffuseColor(c);</span>
<span class="nc" id="L103">            s.setMaterial(material);</span>

<span class="nc" id="L105">            TranslateTransition transition = new TranslateTransition(Duration.seconds(0.1), s);</span>
<span class="nc" id="L106">            transition.setByX(r.nextDouble(-6, 6));</span>
<span class="nc" id="L107">            transition.setByY(r.nextDouble(-6, 6));</span>
<span class="nc" id="L108">            transition.setCycleCount(2);</span>
<span class="nc" id="L109">            transition.setAutoReverse(true);</span>
<span class="nc" id="L110">            transition.play();</span>

<span class="nc" id="L112">            g.getChildren().add(s);</span>

        }
<span class="nc bnc" id="L115" title="All 2 branches missed.">        for (int i = 0; i &lt; ion.neutrons; i++) {</span>
<span class="nc" id="L116">            Sphere s = new Sphere(3);</span>
<span class="nc" id="L117">            double d = r.nextDouble(0, 2 * Math.PI);</span>
<span class="nc" id="L118">            double dx = r.nextDouble(-radius, radius + 1);</span>
<span class="nc" id="L119">            double dy = r.nextDouble(-radius, radius + 1);</span>
<span class="nc" id="L120">            double dz = r.nextDouble(-radius, radius + 1);</span>


<span class="nc" id="L123">            s.setTranslateX(dx * Math.cos(d));</span>
<span class="nc" id="L124">            s.setTranslateY(dy * Math.sin(d));</span>
<span class="nc" id="L125">            s.setTranslateZ(dz);</span>

<span class="nc" id="L127">            PhongMaterial material = new PhongMaterial();</span>
<span class="nc" id="L128">            material.setDiffuseColor(Color.ORANGE);</span>
<span class="nc" id="L129">            s.setMaterial(material);</span>

<span class="nc" id="L131">            TranslateTransition transition = new TranslateTransition(Duration.seconds(0.1), s);</span>
<span class="nc" id="L132">            transition.setByX(r.nextDouble(-6, 6));</span>
<span class="nc" id="L133">            transition.setByY(r.nextDouble(-6, 6));</span>
<span class="nc" id="L134">            transition.setCycleCount(2);</span>
<span class="nc" id="L135">            transition.setAutoReverse(true);</span>
<span class="nc" id="L136">            transition.play();</span>

<span class="nc" id="L138">            g.getChildren().add(s);</span>
        }

<span class="nc" id="L141">        return g;</span>
    }

    private void initMouseControl(Group group, SubScene scene) {
        Rotate xRotate;
        Rotate yRotate;
<span class="nc" id="L147">        group.getTransforms().addAll(</span>
                xRotate = new Rotate(0, Rotate.X_AXIS),
                yRotate = new Rotate(0, Rotate.Y_AXIS)
        );
<span class="nc" id="L151">        xRotate.angleProperty().bind(angleX);</span>
<span class="nc" id="L152">        yRotate.angleProperty().bind(angleY);</span>
<span class="nc" id="L153">        scene.setOnMousePressed(event -&gt; {</span>
<span class="nc" id="L154">            anchorX = event.getSceneX();</span>
<span class="nc" id="L155">            anchorY = event.getSceneY();</span>
<span class="nc" id="L156">            anchorAngleX = angleX.get();</span>
<span class="nc" id="L157">            anchorAngleY = angleY.get();</span>
<span class="nc" id="L158">        });</span>
<span class="nc" id="L159">        scene.setOnMouseDragged(event -&gt; {</span>
<span class="nc" id="L160">            angleX.set(anchorAngleX - (anchorY - event.getSceneY()));</span>
<span class="nc" id="L161">            angleY.set(anchorAngleY + anchorX - event.getSceneX());</span>
<span class="nc" id="L162">        });</span>
<span class="nc" id="L163">    }</span>

    private void createSphereAndPutItInScene(Ion ion) {
<span class="nc" id="L166">        Group group = new Group();</span>
<span class="nc" id="L167">        Camera camera = new PerspectiveCamera(true);</span>
<span class="nc" id="L168">        scene = new SubScene(group, 1200, 500, true, SceneAntialiasing.BALANCED);</span>
<span class="nc" id="L169">        scene.setFill(Color.LIGHTBLUE);</span>
<span class="nc" id="L170">        scene.setCamera(camera);</span>
<span class="nc" id="L171">        camera.translateXProperty().set(0);</span>
<span class="nc" id="L172">        camera.translateYProperty().set(0);</span>
<span class="nc" id="L173">        camera.translateZProperty().set(-500);</span>

<span class="nc" id="L175">        group.translateXProperty().set(0);</span>
<span class="nc" id="L176">        group.translateYProperty().set(0);</span>
<span class="nc" id="L177">        group.translateZProperty().set(0);</span>

<span class="nc" id="L179">        camera.setNearClip(1);</span>
<span class="nc" id="L180">        camera.setFarClip(2000);</span>
<span class="nc" id="L181">        initMouseControl(group, scene);</span>
<span class="nc bnc" id="L182" title="All 2 branches missed.">        if (pane.getScene() != null) {</span>
<span class="nc" id="L183">            stage = (Stage) pane.getScene().getWindow();</span>
<span class="nc" id="L184">            stage.addEventHandler(ScrollEvent.SCROLL, event -&gt; {</span>
<span class="nc" id="L185">                double delta = event.getDeltaY();</span>
<span class="nc" id="L186">                group.translateZProperty().set(group.getTranslateZ() - delta);</span>
<span class="nc" id="L187">            });</span>
        }
<span class="nc" id="L189">        pane.getChildren().add(scene);</span>

        Group g;
<span class="nc bnc" id="L192" title="All 2 branches missed.">        if (ion.isMetal) {</span>
<span class="nc" id="L193">            g = createNucleus(ion, Color.RED);</span>
        } else {
<span class="nc" id="L195">            g = createNucleus(ion, Color.ROYALBLUE);</span>
        }
<span class="nc" id="L197">        group.getChildren().add(g);</span>
<span class="nc" id="L198">        int j = 0;</span>
<span class="nc bnc" id="L199" title="All 2 branches missed.">        for (int i = 0; i &lt; ion.originalElectronsArray.size(); i++) {</span>
<span class="nc" id="L200">            Electron e = ion.originalElectronsArray.get(i);</span>
<span class="nc bnc" id="L201" title="All 2 branches missed.">            if (e.timer != null) {</span>
<span class="nc" id="L202">                ion.originalElectronsArray.get(i).timer.stop();</span>
            }
<span class="nc" id="L204">            e.sphere = new Sphere(1);</span>
<span class="nc bnc" id="L205" title="All 2 branches missed.">            if (i % 2 == 0) {</span>
<span class="nc" id="L206">                e.sphere.getTransforms().add(new Translate(0, j, 70));</span>
<span class="nc" id="L207">                e.sphere.setRotationAxis(Rotate.X_AXIS);</span>
            } else {
<span class="nc" id="L209">                e.sphere.getTransforms().add(new Translate(j, 0, 70));</span>
<span class="nc" id="L210">                e.sphere.setRotationAxis(Rotate.Y_AXIS);</span>
            }
<span class="nc" id="L212">            PhongMaterial material = new PhongMaterial();</span>
<span class="nc bnc" id="L213" title="All 2 branches missed.">            if (ion.isMetal) {</span>
<span class="nc" id="L214">                material.setDiffuseColor(Color.BLUE);</span>
            } else {
<span class="nc" id="L216">                material.setDiffuseColor(Color.GREEN);</span>
            }
<span class="nc" id="L218">            e.sphere.setMaterial(material);</span>
<span class="nc" id="L219">            group.getChildren().add(e.sphere);</span>
<span class="nc" id="L220">            j += 3;</span>
<span class="nc" id="L221">            e.setAnTimer();</span>
<span class="nc" id="L222">            e.timer.start();</span>
        }
<span class="nc" id="L224">        group.getChildren().add(new AmbientLight());</span>
<span class="nc" id="L225">    }</span>

    @FXML
    void goBack2D(ActionEvent event) throws IOException {
<span class="nc" id="L229">        Parent fxmlLoader = FXMLLoader.load(HelloApplication.class.getResource(&quot;Ionic-Scene.fxml&quot;));</span>
<span class="nc" id="L230">        Stage stage1 = (Stage) ((Node) event.getSource()).getScene().getWindow();</span>
<span class="nc" id="L231">        Scene scene1 = new Scene(fxmlLoader);</span>
<span class="nc" id="L232">        stage1.setScene(scene1);</span>
<span class="nc" id="L233">        stage1.show();</span>
<span class="nc" id="L234">    }</span>

    @FXML
    void switchMetal(ActionEvent event) {
<span class="nc" id="L238">        hBox.getChildren().clear();</span>
<span class="nc bnc" id="L239" title="All 4 branches missed.">        switch (counter) {</span>
            case 0 -&gt; {
<span class="nc bnc" id="L241" title="All 2 branches missed.">                for (int i = 0; i &lt; nonMetalIons.size(); i++) {</span>
<span class="nc" id="L242">                    Ion ion = nonMetalIons.get(i);</span>
<span class="nc" id="L243">                    Button b = new Button(nonMetalIons.get(i).toString());</span>
<span class="nc" id="L244">                    b.setMinSize(70, 50);</span>
<span class="nc" id="L245">                    hBox.getChildren().add(b);</span>
<span class="nc" id="L246">                    b.setOnAction(e -&gt; {</span>
<span class="nc" id="L247">                        pane.getChildren().remove(scene);</span>
<span class="nc" id="L248">                        createSphereAndPutItInScene(ion);</span>
<span class="nc" id="L249">                    });</span>
                }
<span class="nc" id="L251">                counter = 1;</span>
<span class="nc" id="L252">                switchButton.setText(&quot;Non-Metal&quot;);</span>
<span class="nc" id="L253">            }</span>
            case 1 -&gt; {
<span class="nc bnc" id="L255" title="All 2 branches missed.">                for (int i = 0; i &lt; metalIons.size(); i++) {</span>
<span class="nc" id="L256">                    Ion ion = metalIons.get(i);</span>
<span class="nc" id="L257">                    Button b = new Button(metalIons.get(i).toString());</span>
<span class="nc" id="L258">                    b.setMinSize(70, 50);</span>
<span class="nc" id="L259">                    hBox.getChildren().add(b);</span>
<span class="nc" id="L260">                    b.setOnAction(e -&gt; {</span>
<span class="nc" id="L261">                        pane.getChildren().remove(scene);</span>
<span class="nc" id="L262">                        createSphereAndPutItInScene(ion);</span>
<span class="nc" id="L263">                    });</span>
                }
<span class="nc bnc" id="L265" title="All 2 branches missed.">                if (arrayOf2Ions.isEmpty()) {</span>
<span class="nc" id="L266">                    counter = 0;</span>
                } else {
<span class="nc" id="L268">                    counter = 2;</span>
                }
<span class="nc" id="L270">                switchButton.setText(&quot;Metal&quot;);</span>

<span class="nc" id="L272">            }</span>
            case 2 -&gt; {
<span class="nc bnc" id="L274" title="All 2 branches missed.">                for (int i = 0; i &lt; arrayOf2Ions.size(); i++) {</span>
<span class="nc" id="L275">                    Ion ion = arrayOf2Ions.get(i);</span>
<span class="nc" id="L276">                    Button b = new Button(arrayOf2Ions.get(i).toString());</span>
<span class="nc" id="L277">                    b.setMinSize(70, 50);</span>
<span class="nc" id="L278">                    hBox.getChildren().add(b);</span>
<span class="nc" id="L279">                    b.setOnAction(e -&gt; {</span>
<span class="nc" id="L280">                        pane.getChildren().remove(scene);</span>
<span class="nc" id="L281">                        create2SphereAndPutItInScene(ion);</span>
<span class="nc" id="L282">                    });</span>
                }
<span class="nc" id="L284">                switchButton.setText(&quot;PoyIons&quot;);</span>
<span class="nc" id="L285">                counter = 0;</span>
            }
        }
<span class="nc" id="L288">    }</span>

    private void create2SphereAndPutItInScene(Ion ion) {
<span class="nc" id="L291">        Group cation = createNucleus(ion.metal, Color.RED);</span>

<span class="nc" id="L293">        PhongMaterial material = new PhongMaterial();</span>
<span class="nc" id="L294">        material.setDiffuseColor(Color.rgb(255, 255, 255, 0.01));</span>
<span class="nc" id="L295">        material.setSpecularColor(Color.rgb(255, 255, 255, 0.01));</span>
<span class="nc" id="L296">        Sphere cationCloud = new Sphere(100);</span>
<span class="nc" id="L297">        Group anion = createNucleus(ion.nonMetal, Color.BLUE);</span>

<span class="nc" id="L299">        cation.setTranslateX(100);</span>
<span class="nc" id="L300">        cationCloud.setTranslateX(100);</span>
<span class="nc" id="L301">        anion.setTranslateX(-100);</span>

<span class="nc" id="L303">        Group group = new Group();</span>
<span class="nc" id="L304">        group.getChildren().add(cation);</span>
<span class="nc" id="L305">        group.getChildren().add(anion);</span>

<span class="nc" id="L307">        putElectrons(ion.metal, group, 100, 0, Color.YELLOW);</span>
<span class="nc" id="L308">        putElectrons(ion.nonMetal, group, -100, 0, Color.GREEN);</span>

<span class="nc" id="L310">        group.getChildren().add(new AmbientLight());</span>
<span class="nc" id="L311">        Camera camera = new PerspectiveCamera(true);</span>
<span class="nc" id="L312">        scene = new SubScene(group, 1200, 500, true, SceneAntialiasing.BALANCED);</span>
<span class="nc" id="L313">        scene.setFill(Color.LIGHTBLUE);</span>
<span class="nc" id="L314">        scene.setCamera(camera);</span>

<span class="nc" id="L316">        camera.translateXProperty().set(0);</span>
<span class="nc" id="L317">        camera.translateYProperty().set(0);</span>
<span class="nc" id="L318">        camera.translateZProperty().set(-500);</span>
<span class="nc" id="L319">        camera.setNearClip(1);</span>
<span class="nc" id="L320">        camera.setFarClip(2000);</span>

<span class="nc" id="L322">        group.translateXProperty().set(0);</span>
<span class="nc" id="L323">        group.translateYProperty().set(0);</span>
<span class="nc" id="L324">        group.translateZProperty().set(0);</span>

<span class="nc" id="L326">        initMouseControl(group, scene);</span>
<span class="nc bnc" id="L327" title="All 2 branches missed.">        if (pane.getScene() != null) {</span>
<span class="nc" id="L328">            stage = (Stage) pane.getScene().getWindow();</span>
<span class="nc" id="L329">            stage.addEventHandler(ScrollEvent.SCROLL, event -&gt; {</span>
<span class="nc" id="L330">                double delta = event.getDeltaY();</span>
<span class="nc" id="L331">                group.translateZProperty().set(group.getTranslateZ() - delta);</span>
<span class="nc" id="L332">            });</span>
        }
<span class="nc" id="L334">        pane.getChildren().add(scene);</span>
<span class="nc" id="L335">    }</span>

    private void putElectrons(Ion ion, Group group, double x, double y, Color c) {
<span class="nc" id="L338">        Random r = new Random();</span>
<span class="nc" id="L339">        int j = 0;</span>
<span class="nc bnc" id="L340" title="All 2 branches missed.">        for (int i = 0; i &lt; ion.electronsArray.size(); i++) {</span>

<span class="nc" id="L342">            Electron e = ion.electronsArray.get(i);</span>
<span class="nc bnc" id="L343" title="All 2 branches missed.">            if (e.timer != null) {</span>
<span class="nc" id="L344">                ion.electronsArray.get(i).timer.stop();</span>
            }
<span class="nc" id="L346">            e.sphere = new Sphere(1, 100);</span>
<span class="nc bnc" id="L347" title="All 2 branches missed.">            if (i % 2 == 0) {</span>
<span class="nc" id="L348">                e.sphere.setTranslateX(x);</span>
<span class="nc" id="L349">                e.sphere.getTransforms().add(new Translate(0, y + j, 70));</span>
<span class="nc" id="L350">                e.sphere.setRotationAxis(Rotate.X_AXIS);</span>
            } else {
<span class="nc" id="L352">                e.sphere.setTranslateX(x);</span>
<span class="nc" id="L353">                e.sphere.getTransforms().add(new Translate(j, 0, 70));</span>
<span class="nc" id="L354">                e.sphere.setRotationAxis(Rotate.Y_AXIS);</span>
            }

<span class="nc" id="L357">            PhongMaterial material = new PhongMaterial();</span>
<span class="nc bnc" id="L358" title="All 2 branches missed.">            if (i &gt;= ion.originalElectronsArray.size()) {</span>
<span class="nc" id="L359">                material.setDiffuseColor(Color.BLUE);</span>
            } else {
<span class="nc" id="L361">                material.setDiffuseColor(c);</span>
            }
<span class="nc" id="L363">            e.sphere.setMaterial(material);</span>
<span class="nc" id="L364">            group.getChildren().add(e.sphere);</span>
<span class="nc" id="L365">            j += 3;</span>
<span class="nc" id="L366">            e.setAnTimer();</span>
<span class="nc" id="L367">            e.timer.start();</span>

        }
<span class="nc" id="L370">    }</span>
}



</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.11.202310140853</span></div></body></html>